<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å üå∏</title>
  
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script defer crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script defer crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script defer src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <style>
    body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto',sans-serif;background:linear-gradient(135deg, #fdfcfb 0%, #fff5f7 100%);}
    .gradient-pink{background:linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);}
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const AdminPanel = () => {
      const [activeTab, setActiveTab] = useState('orders');
      const [products, setProducts] = useState([]);
      const [orders, setOrders] = useState([]);
      const [customers, setCustomers] = useState([]);
      const [loading, setLoading] = useState(true);
      const [editingProduct, setEditingProduct] = useState(null);
      const [showProductForm, setShowProductForm] = useState(false);
      const [supabase, setSupabase] = useState(null);
      
      const [productForm, setProductForm] = useState({
        name: '', 
        name_kk: '', 
        description: '', 
        description_kk: '',
        price: '', 
        category: '', 
        category_kk: '',
        image_url: '',
        badge: '',
        available: true
      });
      
      const [settings, setSettings] = useState({
        kaspi_phone: '',
        kaspi_link: '',
        shop_name: '–¶–≤–µ—Ç–æ—á–Ω–∞—è –õ–∞–≤–∫–∞',
        shop_phone: '',
        contact_phone: '',
        contact_address: '',
        payment_enabled: false
      });
      
      const [orderFilter, setOrderFilter] = useState('all');
      const [toast, setToast] = useState(null);

      const formatDateTime = (utcDate) => {
        if (!utcDate) return '';
        const date = new Date(utcDate);
        return date.toLocaleString('ru-RU', {
          timeZone: 'Asia/Almaty',
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit'
        });
      };

      useEffect(() => {
        if (window.Telegram?.WebApp) {
          window.Telegram.WebApp.ready();
          window.Telegram.WebApp.expand();
        }
        initSupabase();
      }, []);

      const initSupabase = async () => {
        try {
          const response = await fetch('/api/config');
          const config = await response.json();
          
          const supabaseClient = window.supabase.createClient(
            config.supabaseUrl,
            config.supabaseKey
          );
          
          setSupabase(supabaseClient);
          await loadData(supabaseClient);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
          showToast('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', 'error');
        }
      };

      const loadData = async (client) => {
        try {
          // –¢–æ–≤–∞—Ä—ã
          const { data: productsData } = await client
            .from('flowers_products')
            .select('*')
            .order('name');
          
          setProducts(productsData || []);
          
          // –ó–∞–∫–∞–∑—ã
          const { data: ordersData } = await client
            .from('flowers_orders')
            .select('*')
            .order('created_at', { ascending: false });
          
          setOrders(ordersData || []);
          
          // –ö–ª–∏–µ–Ω—Ç—ã
          const { data: customersData } = await client
            .from('flowers_customers')
            .select('*')
            .order('created_at', { ascending: false });
          
          setCustomers(customersData || []);
          
          // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
          const { data: settingsData } = await client
            .from('flowers_settings')
            .select('*')
            .single();
          
          if (settingsData) setSettings(settingsData);
          
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
        } finally {
          setLoading(false);
        }
      };

      const showToast = (message, type = 'success') => {
        setToast({ message, type });
        setTimeout(() => setToast(null), 3000);
      };

      const saveProduct = async () => {
        if (!productForm.name || !productForm.price) {
          showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
          return;
        }

        try {
          if (editingProduct) {
            await supabase
              .from('flowers_products')
              .update({
                ...productForm,
                price: parseFloat(productForm.price),
                updated_at: new Date().toISOString()
              })
              .eq('id', editingProduct.id);
            
            showToast('–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—ë–Ω! üå∏');
          } else {
            await supabase
              .from('flowers_products')
              .insert({
                ...productForm,
                price: parseFloat(productForm.price)
              });
            
            showToast('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω! üå∏');
          }

          setShowProductForm(false);
          setEditingProduct(null);
          setProductForm({
            name: '', name_kk: '', description: '', description_kk: '',
            price: '', category: '', category_kk: '', image_url: '', badge: '', available: true
          });
          loadData(supabase);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
          showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        }
      };

      const deleteProduct = async (id) => {
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')) return;

        try {
          await supabase
            .from('flowers_products')
            .delete()
            .eq('id', id);
          
          showToast('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω');
          loadData(supabase);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
          showToast('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
        }
      };

      const updateOrderStatus = async (orderId, newStatus) => {
        try {
          const { data: order } = await supabase
            .from('flowers_orders')
            .update({ status: newStatus })
            .eq('id', orderId)
            .select()
            .single();

          await fetch('/api/notify-status', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              userId: order.telegram_user_id,
              status: newStatus,
              orderNumber: orderId.slice(-6),
              orderId: orderId,
              shopPhone: settings.shop_phone
            })
          });

          showToast('–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—ë–Ω! ‚úÖ');
          loadData(supabase);
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:', error);
          showToast('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è', 'error');
        }
      };

      const saveSettings = async () => {
        try {
          await supabase
            .from('flowers_settings')
            .update(settings)
            .eq('id', 1);

          showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã! ‚öôÔ∏è');
        } catch (error) {
          console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:', error);
          showToast('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        }
      };

      const filteredOrders = orderFilter === 'all' 
        ? orders 
        : orders.filter(order => order.status === orderFilter);

      const stats = {
        totalOrders: orders.length,
        pending: orders.filter(o => o.status === 'pending').length,
        processing: orders.filter(o => o.status === 'processing').length,
        delivered: orders.filter(o => o.status === 'delivered').length,
        totalRevenue: orders
          .filter(o => o.status === 'delivered')
          .reduce((sum, o) => sum + (o.total || 0), 0)
      };

      if (loading) {
        return (
          <div className="min-h-screen flex items-center justify-center">
            <div className="text-center">
              <div className="text-6xl mb-4 animate-bounce">üå∏</div>
              <p className="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-pink-50 via-white to-rose-50 pb-20">
          {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
          <div className="bg-gradient-to-r from-pink-500 to-rose-500 text-white p-6 shadow-lg">
            <h1 className="text-2xl font-bold mb-1">üå∏ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
            <p className="text-pink-100">–¶–≤–µ—Ç–æ—á–Ω–∞—è –õ–∞–≤–∫–∞</p>
          </div>

          {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */}
          <div className="p-4 grid grid-cols-2 gap-3 mb-4">
            <div className="bg-white rounded-xl p-4 shadow-sm">
              <p className="text-gray-500 text-sm mb-1">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</p>
              <p className="text-2xl font-bold text-gray-800">{stats.totalOrders}</p>
            </div>
            <div className="bg-white rounded-xl p-4 shadow-sm">
              <p className="text-gray-500 text-sm mb-1">–î–æ—Ö–æ–¥</p>
              <p className="text-2xl font-bold text-green-600">{stats.totalRevenue} ‚Ç∏</p>
            </div>
            <div className="bg-amber-100 rounded-xl p-4 shadow-sm">
              <p className="text-amber-700 text-sm mb-1">–û–∂–∏–¥–∞—é—Ç</p>
              <p className="text-2xl font-bold text-amber-700">{stats.pending}</p>
            </div>
            <div className="bg-green-100 rounded-xl p-4 shadow-sm">
              <p className="text-green-700 text-sm mb-1">–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</p>
              <p className="text-2xl font-bold text-green-700">{stats.delivered}</p>
            </div>
          </div>

          {/* –¢–∞–±—ã */}
          <div className="px-4 mb-4">
            <div className="bg-white rounded-xl p-2 shadow-sm flex gap-2">
              <button
                onClick={() => setActiveTab('orders')}
                className={`flex-1 py-2 rounded-lg font-medium transition-all ${
                  activeTab === 'orders' 
                    ? 'bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md' 
                    : 'text-gray-600'
                }`}
              >
                üìã –ó–∞–∫–∞–∑—ã
              </button>
              <button
                onClick={() => setActiveTab('products')}
                className={`flex-1 py-2 rounded-lg font-medium transition-all ${
                  activeTab === 'products' 
                    ? 'bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md' 
                    : 'text-gray-600'
                }`}
              >
                üå∫ –¢–æ–≤–∞—Ä—ã
              </button>
              <button
                onClick={() => setActiveTab('settings')}
                className={`flex-1 py-2 rounded-lg font-medium transition-all ${
                  activeTab === 'settings' 
                    ? 'bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md' 
                    : 'text-gray-600'
                }`}
              >
                ‚öôÔ∏è
              </button>
            </div>
          </div>

          {/* –ó–∞–∫–∞–∑—ã */}
          {activeTab === 'orders' && (
            <div className="px-4">
              {/* –§–∏–ª—å—Ç—Ä */}
              <div className="bg-white rounded-xl p-3 shadow-sm mb-4">
                <select
                  value={orderFilter}
                  onChange={(e) => setOrderFilter(e.target.value)}
                  className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                >
                  <option value="all">–í—Å–µ –∑–∞–∫–∞–∑—ã</option>
                  <option value="pending">‚è∞ –û–∂–∏–¥–∞—é—Ç</option>
                  <option value="processing">üë®‚Äçüç≥ –ì–æ—Ç–æ–≤—è—Ç—Å—è</option>
                  <option value="ready">‚úÖ –ì–æ—Ç–æ–≤—ã</option>
                  <option value="delivered">üéâ –î–æ—Å—Ç–∞–≤–ª–µ–Ω—ã</option>
                  <option value="cancelled">‚ùå –û—Ç–º–µ–Ω–µ–Ω—ã</option>
                </select>
              </div>

              {/* –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ */}
              <div className="space-y-3">
                {filteredOrders.map(order => (
                  <div key={order.id} className="bg-white rounded-xl p-4 shadow-sm">
                    <div className="flex justify-between items-start mb-3">
                      <div>
                        <p className="font-bold text-gray-800">
                          –ó–∞–∫–∞–∑ #{order.id.slice(-6)}
                        </p>
                        <p className="text-sm text-gray-500">
                          {formatDateTime(order.created_at)}
                        </p>
                      </div>
                      <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                        order.status === 'delivered' ? 'bg-green-100 text-green-700' :
                        order.status === 'ready' ? 'bg-blue-100 text-blue-700' :
                        order.status === 'processing' ? 'bg-yellow-100 text-yellow-700' :
                        order.status === 'cancelled' ? 'bg-red-100 text-red-700' :
                        'bg-gray-100 text-gray-700'
                      }`}>
                        {order.status === 'pending' ? '‚è∞ –û–∂–∏–¥–∞–µ—Ç' :
                         order.status === 'processing' ? 'üë®‚Äçüç≥ –ì–æ—Ç–æ–≤–∏—Ç—Å—è' :
                         order.status === 'ready' ? '‚úÖ –ì–æ—Ç–æ–≤' :
                         order.status === 'delivered' ? 'üéâ –î–æ—Å—Ç–∞–≤–ª–µ–Ω' :
                         order.status === 'cancelled' ? '‚ùå –û—Ç–º–µ–Ω—ë–Ω' : order.status}
                      </span>
                    </div>

                    <div className="border-t border-gray-100 pt-3 mb-3">
                      <p className="text-sm text-gray-600 mb-1">
                        <strong>–ö–ª–∏–µ–Ω—Ç:</strong> {order.customer_name}
                      </p>
                      <p className="text-sm text-gray-600 mb-1">
                        <strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {order.customer_phone}
                      </p>
                      {order.comment && (
                        <p className="text-sm text-gray-600 mb-1">
                          <strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> {order.comment}
                        </p>
                      )}
                      <div className="mt-2">
                        <p className="text-sm text-gray-500 mb-1">–¢–æ–≤–∞—Ä—ã:</p>
                        {order.items?.map((item, idx) => (
                          <p key={idx} className="text-sm text-gray-700">
                            ‚Ä¢ {item.name} x{item.quantity} = {item.price * item.quantity} ‚Ç∏
                          </p>
                        ))}
                      </div>
                      <p className="font-bold text-pink-600 mt-2">
                        –ò—Ç–æ–≥–æ: {order.total} ‚Ç∏
                      </p>
                    </div>

                    {/* –ö–Ω–æ–ø–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ */}
                    <div className="flex gap-2 flex-wrap">
                      {order.status === 'pending' && (
                        <button
                          onClick={() => updateOrderStatus(order.id, 'processing')}
                          className="px-4 py-2 bg-yellow-500 text-white rounded-lg text-sm font-medium"
                        >
                          ‚úÖ –ü—Ä–∏–Ω—è—Ç—å
                        </button>
                      )}
                      {order.status === 'processing' && (
                        <button
                          onClick={() => updateOrderStatus(order.id, 'ready')}
                          className="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium"
                        >
                          ‚úÖ –ì–æ—Ç–æ–≤–æ
                        </button>
                      )}
                      {order.status === 'ready' && (
                        <button
                          onClick={() => updateOrderStatus(order.id, 'delivered')}
                          className="px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-medium"
                        >
                          üöö –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
                        </button>
                      )}
                      {order.status !== 'cancelled' && order.status !== 'delivered' && (
                        <button
                          onClick={() => updateOrderStatus(order.id, 'cancelled')}
                          className="px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-medium"
                        >
                          ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å
                        </button>
                      )}
                    </div>
                  </div>
                ))}

                {filteredOrders.length === 0 && (
                  <div className="text-center py-20">
                    <div className="text-6xl mb-4">üå∑</div>
                    <p className="text-gray-500">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* –¢–æ–≤–∞—Ä—ã */}
          {activeTab === 'products' && (
            <div className="px-4">
              <button
                onClick={() => {
                  setShowProductForm(true);
                  setEditingProduct(null);
                  setProductForm({
                    name: '', name_kk: '', description: '', description_kk: '',
                    price: '', category: '', category_kk: '', image_url: '', badge: '', available: true
                  });
                }}
                className="w-full mb-4 bg-gradient-to-r from-pink-500 to-rose-500 text-white py-3 rounded-xl font-bold shadow-lg"
              >
                ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
              </button>

              {/* –§–æ—Ä–º–∞ —Ç–æ–≤–∞—Ä–∞ */}
              {showProductForm && (
                <div className="bg-white rounded-xl p-4 shadow-lg mb-4">
                  <h3 className="font-bold text-lg mb-4">
                    {editingProduct ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä' : '–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä'}
                  </h3>
                  
                  <div className="space-y-3">
                    <input
                      type="text"
                      placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (RU)"
                      value={productForm.name}
                      onChange={(e) => setProductForm({...productForm, name: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <input
                      type="text"
                      placeholder="Atau—ã (KK)"
                      value={productForm.name_kk}
                      onChange={(e) => setProductForm({...productForm, name_kk: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <textarea
                      placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (RU)"
                      value={productForm.description}
                      onChange={(e) => setProductForm({...productForm, description: e.target.value})}
                      rows="2"
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <textarea
                      placeholder="–°–∏–ø–∞—Ç—Ç–∞–º–∞ (KK)"
                      value={productForm.description_kk}
                      onChange={(e) => setProductForm({...productForm, description_kk: e.target.value})}
                      rows="2"
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <input
                      type="number"
                      placeholder="–¶–µ–Ω–∞"
                      value={productForm.price}
                      onChange={(e) => setProductForm({...productForm, price: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <input
                      type="text"
                      placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è (RU)"
                      value={productForm.category}
                      onChange={(e) => setProductForm({...productForm, category: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <input
                      type="text"
                      placeholder="–°–∞–Ω–∞—Ç (KK)"
                      value={productForm.category_kk}
                      onChange={(e) => setProductForm({...productForm, category_kk: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <input
                      type="text"
                      placeholder="URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                      value={productForm.image_url}
                      onChange={(e) => setProductForm({...productForm, image_url: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    />
                    <select
                      value={productForm.badge}
                      onChange={(e) => setProductForm({...productForm, badge: e.target.value})}
                      className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                    >
                      <option value="">–ë–µ–∑ –±–µ–π–¥–∂–∞</option>
                      <option value="new">üéâ –ù–æ–≤–∏–Ω–∫–∞</option>
                      <option value="hit">‚≠ê –•–∏—Ç</option>
                    </select>
                    
                    <div className="flex items-center gap-2">
                      <input
                        type="checkbox"
                        id="available"
                        checked={productForm.available}
                        onChange={(e) => setProductForm({...productForm, available: e.target.checked})}
                        className="w-5 h-5"
                      />
                      <label htmlFor="available" className="text-gray-700">–í –Ω–∞–ª–∏—á–∏–∏</label>
                    </div>
                  </div>

                  <div className="flex gap-2 mt-4">
                    <button
                      onClick={saveProduct}
                      className="flex-1 bg-green-500 text-white py-3 rounded-lg font-bold"
                    >
                      ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                    <button
                      onClick={() => {
                        setShowProductForm(false);
                        setEditingProduct(null);
                      }}
                      className="flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-bold"
                    >
                      ‚ùå –û—Ç–º–µ–Ω–∞
                    </button>
                  </div>
                </div>
              )}

              {/* –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ */}
              <div className="space-y-3">
                {products.map(product => (
                  <div key={product.id} className="bg-white rounded-xl p-4 shadow-sm">
                    <div className="flex gap-3">
                      <div className="w-20 h-20 bg-gradient-to-br from-pink-100 to-rose-100 rounded-lg flex items-center justify-center flex-shrink-0">
                        {product.image_url ? (
                          <img src={product.image_url} alt={product.name} className="w-full h-full object-cover rounded-lg"/>
                        ) : (
                          <span className="text-3xl">üå∫</span>
                        )}
                      </div>
                      <div className="flex-1">
                        <h3 className="font-bold text-gray-800">{product.name}</h3>
                        <p className="text-sm text-gray-500">{product.description}</p>
                        <p className="font-bold text-pink-600 mt-1">{product.price} ‚Ç∏</p>
                        <p className="text-xs text-gray-400">
                          {product.available ? '‚úÖ –í –Ω–∞–ª–∏—á–∏–∏' : '‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                        </p>
                      </div>
                    </div>
                    <div className="flex gap-2 mt-3">
                      <button
                        onClick={() => {
                          setEditingProduct(product);
                          setProductForm(product);
                          setShowProductForm(true);
                        }}
                        className="flex-1 bg-blue-500 text-white py-2 rounded-lg text-sm font-medium"
                      >
                        ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
                      </button>
                      <button
                        onClick={() => deleteProduct(product.id)}
                        className="flex-1 bg-red-500 text-white py-2 rounded-lg text-sm font-medium"
                      >
                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                      </button>
                    </div>
                  </div>
                ))}

                {products.length === 0 && (
                  <div className="text-center py-20">
                    <div className="text-6xl mb-4">üå∑</div>
                    <p className="text-gray-500">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</p>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */}
          {activeTab === 'settings' && (
            <div className="px-4">
              <div className="bg-white rounded-xl p-4 shadow-sm space-y-4">
                <h3 className="font-bold text-lg mb-3">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    –ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
                  </label>
                  <input
                    type="text"
                    value={settings.shop_name}
                    onChange={(e) => setSettings({...settings, shop_name: e.target.value})}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    –¢–µ–ª–µ—Ñ–æ–Ω –º–∞–≥–∞–∑–∏–Ω–∞
                  </label>
                  <input
                    type="tel"
                    value={settings.shop_phone}
                    onChange={(e) => setSettings({...settings, shop_phone: e.target.value})}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
                  </label>
                  <input
                    type="tel"
                    value={settings.contact_phone}
                    onChange={(e) => setSettings({...settings, contact_phone: e.target.value})}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    –ê–¥—Ä–µ—Å
                  </label>
                  <input
                    type="text"
                    value={settings.contact_address}
                    onChange={(e) => setSettings({...settings, contact_address: e.target.value})}
                    className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                  />
                </div>

                <div className="border-t border-gray-200 pt-4 mt-4">
                  <h4 className="font-semibold text-gray-800 mb-3">üí≥ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø–ª–∞—Ç—ã</h4>
                  
                  <div className="flex items-center gap-2 mb-3">
                    <input
                      type="checkbox"
                      id="payment_enabled"
                      checked={settings.payment_enabled}
                      onChange={(e) => setSettings({...settings, payment_enabled: e.target.checked})}
                      className="w-5 h-5"
                    />
                    <label htmlFor="payment_enabled" className="text-gray-700">
                      –í–∫–ª—é—á–∏—Ç—å –æ–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç—É
                    </label>
                  </div>

                  {settings.payment_enabled && (
                    <>
                      <div className="mb-3">
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Kaspi —Ç–µ–ª–µ—Ñ–æ–Ω
                        </label>
                        <input
                          type="tel"
                          value={settings.kaspi_phone}
                          onChange={(e) => setSettings({...settings, kaspi_phone: e.target.value})}
                          placeholder="7001234567"
                          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-1">
                          Kaspi —Å—Å—ã–ª–∫–∞
                        </label>
                        <input
                          type="text"
                          value={settings.kaspi_link}
                          onChange={(e) => setSettings({...settings, kaspi_link: e.target.value})}
                          placeholder="https://kaspi.kz/pay/..."
                          className="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-pink-500"
                        />
                      </div>
                    </>
                  )}
                </div>

                <button
                  onClick={saveSettings}
                  className="w-full bg-gradient-to-r from-pink-500 to-rose-500 text-white py-3 rounded-xl font-bold shadow-lg mt-4"
                >
                  üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
              </div>
            </div>
          )}

          {/* Toast */}
          {toast && (
            <div className="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 max-w-sm w-full px-4">
              <div className={`${
                toast.type === 'success' ? 'bg-pink-600' : 'bg-red-500'
              } text-white px-6 py-4 rounded-2xl shadow-2xl`}>
                <div className="flex items-center gap-3">
                  <span className="text-2xl">{toast.type === 'success' ? '‚úÖ' : '‚ùå'}</span>
                  <div className="font-medium">{toast.message}</div>
                </div>
              </div>
            </div>
          )}
        </div>
      );
    };

    ReactDOM.render(<AdminPanel />, document.getElementById('root'));
  </script>
</body>
</html>
